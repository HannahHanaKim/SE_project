<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Student</title>
<style>
tr.borderBottom td {
   border-bottom: 1pt solid black;
   font-size:25px;
}
</style>
</head>

<body>
<script src="https://www.gstatic.com/firebasejs/4.10.1/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyCx0MniEWhgYchvmEaJjg1iVh_V5AgjWJ4",
    authDomain: "seproject-5d1c4.firebaseapp.com",
    databaseURL: "https://seproject-5d1c4.firebaseio.com",
    projectId: "seproject-5d1c4",
    storageBucket: "seproject-5d1c4.appspot.com",
    messagingSenderId: "633807614764"
  };
  firebase.initializeApp(config);
  
  var a = location.href;
  alert(a);
  var b = location.href.lastIndexOf('=')+1;
  alert(b);
  var c = location.href.substring(b);
  alert(c);
  var UserID = c;

	  /*alert('index: '+location.href.lastIndexOf('=')+1);
	  var UserID = locationHref.substring(location.href.lastIndexOf('=')+1);
	  alert('UserID: '+UserID);*/

	  //var UserID = location.href.substr(location.href.lastIndexOf('=')+1);
	  
	  
  

  
  
  
  var firebaseDatabase;
  firebaseDatabase=firebase.database();
  
  
  <!-- bring data from database -->
  /** 여기서 select box에서 선택된 값들을 가져온다.**/
	var yearTarget = document.getElementById("year"); //year 의 select box 지
	var year_text = yearTarget.option[yearTarget.selectedIndex].text; //year box의 값을 가져온다. 
	
	var semesterTarget = document.getElementById("semester"); //semester 의 select box 지
	var semester_text = semesterTarget.option[semesterTarget.selectedIndex].text; //semester box의 값을 가져온다.
	
	<!-- 과목들 저장  -->
	var subject1 = '소프트웨어 공학';
	var subject2 = '컴퓨터 그래픽스';
	var subject3 = '모바일 프로그래밍';
	var subject4 = '산업세미나';
	
	<!-- student data 저장  -->
	var usersRef = firebaseDatabase.ref('WEBusers/'+id +'/subjects');
	//var usersRef = firebase.database().ref('WEBusers/'+id +'/subjects');
	var data = {
		  year:year_text,
		  semester:semester_text
		  subject1:subject1
		  subject2:subject2
		  subject3:subject3
		  subject4:subject4
	}
	usersRef.set(data);
	
	<!-- 교수가 성적을 입력함과 동시에 student 디비가 업데이트 됨!: 성적 업데이트! -->

	
	
  <!-- 학생이 들은 과목과 성적 불러오기!  --> 
  
  function thanksList(){
      
     var subjectRef = firebaseDatabase.ref('WEBusers/'+id+'/subjects');
     subjectRef.on('child_added', on_subject_list); //과목 다 불러오기!
     
  }
  
  function on_subject_list(data){
     var key = data.key;
     
     var Data = data.val();
     
     var year = Data.year;
     var semester = Data.semester;
     var subject = Data.subject;
     var score = Data.score;
     
     //alert(name +"/"+ number + "/"+score);     
     if((year == year_text) && (semester == semester_text)) { //만약 년도랑 학기가 맞으면 정보를 불러와서 띄워줌.  
     	var text = 
        	"<tr class=\"borderBottom\" align=\"center\"><td>"+name+"</td><td>"+score+"</td></tr>";  
     	document.getElementById("subjectList").innerHTML += text;
     }

  }
  
  
</script>


<h1 align="center">성적조회</h1>
<br>
<p>
Year:
<select name="year" id="year">
<option value="select">Select Year</option>
<option value="2013">2013</option>
<option value="2014">2014</option>
<option value="2015">2015</option>
<option value="2016">2016</option>
<option value="2017">2017</option>
<option value="2018">2018</option>
</select>
&nbsp;

Semester:
<select name="semester" id="semester">
<option value="select">Select Semester</option>
<option value="sprint">1학기</option>
<option value="fall">2학기</option>
<option value="summer">여름학기</option>
<option value="winter">겨울학기</option>
</select>
&nbsp;
<input type="button" name="managerSubmit" value="Search" onclick="thanksList()">
<br><br>

<table id="subjectList" align="center"></table>

</body>

</html>